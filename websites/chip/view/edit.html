<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="data:;base64,=">  <!-- 禁止加载facon.ico -->
    <title>chip edit</title>

    <!-- 软件包导入(jquery放在anguarjs前， bootstrap放在jquery-ui前) -->
    <script src="/node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script> 
    <script src="/node_modules/angular/angular.min.js" type="text/javascript"></script>
    <!-- bootstrap -->   
    <script src="/node_modules/popper.js/dist/umd/popper.min.js" type="text/javascript"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <link  href="/node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- toastr(notify) -->
    <script src="/node_modules/toastr/build/toastr.min.js" type="text/javascript"></script>
    <link  href="/node_modules/toastr/build/toastr.min.css" rel="stylesheet" /> 
    <!-- font-awesome -->
    <link  href="/node_modules/font-awesome/css/font-awesome.min.css" rel="stylesheet" />  
    
    <!-- 自定义 -->   
    <script src="/view/js/library.js" type="text/javascript"></script>
    <link  href="/view/css/all.css" rel="stylesheet" />
    <script src="/chip/view/js/edit.js" type="text/javascript"></script>
    <style>
    .item>div { height: 812px; }
    .item>div>div { line-height: 20px; margin-top:5px; font-size: 12px; border-bottom: 1px dashed #cccccc; cursor: pointer; }

    .sel { color: #ff0000; }
    </style>
</head>
<body ng-app="editApp">

    <div ng-include="'/view/nav.html'"></div>
    <div id="wrapper" class="container-fluid" ng-controller="editCtrl">
        <div class="row">
            <div class="col-md border border-success rounded my-2 mx-1">
                <div class="row item mt-1">
                    <div class="col-md-2 px-1 bg-light chipContainer">
                        <div class="pl-1" ng-repeat="x in chiplist" ng-click="chipSelect(x);" title="{{x.name}}, {{x.width}}">
                            {{x.name|limitTo:10}}
                        </div>
                    </div>
                    <div class="col-md-2 px-1 moduleContainer">
                        <div class="pl-1" ng-repeat="x in modulelist" ng-click="moduleSelect(x);" title="{{x.name}}, {{x.fullname}}">
                            {{x.name|limitTo:10}}
                        </div>
                    </div>
                    <div class="col-md px-1 bg-light registerContainer">
                        <div class="pl-1" ng-repeat="x in registerlist" ng-click="registerSelect(x);" title="{{x.name}}, {{x.fullname}}, {{x.address}}">
                            {{x.name|limitTo:20}}
                        </div>
                    </div>
                    <div class="col-md bitsContainer">
                        <div class="pl-1" ng-repeat="x in bitslist" ng-click="bitsSelect(x);" title="{{x.name}}, {{x.fullname}}">
                            <b>{{x.name|limitTo:20}}</b>
                            <span style="color: #888888;">/{{x.rw}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-7 border border-secondary rounded my-2 mr-1">
                <!-- 芯片 -->
                <div class="row mt-4">
                    <div class="col-md-8">
                        <input type="text" class="form-control" ng-model="chip.name" placeholder="芯片名称">
                    </div>
                    <div class="col-md">
                        <input type="text" class="form-control" ng-model="chip.width" placeholder="总线宽度">  
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md text-right">
                        <button type="button" class="btn btn-outline-danger px-3" ng-show="chip.id" data-toggle="modal" data-target="#chipDeleteConfirmWnd">删除</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="chip.id" ng-click="chipSubmit();">编辑</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="!chip.id" ng-click="chipSubmit();">创建</button>
                    </div>
                </div>
                <!-- 芯片模块 -->
                <div class="row mt-4">
                    <div class="col-md">
                        <input type="text" class="form-control" ng-model="module.name" placeholder="模块名称">
                    </div>
                    <div class="col-md-8">
                        <input type="text" class="form-control" ng-model="module.fullname" placeholder="模块全称">
                    </div>
                </div>
                <div class="row mt-2" style="height: 40px;">
                    <div class="col-md text-right">
                        <button type="button" class="btn btn-outline-danger px-3" ng-show="module.id" data-toggle="modal" data-target="#moduleDeleteConfirmWnd">删除</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="module.id" ng-click="moduleSubmit();">编辑</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="chip.id && !module.id" ng-click="moduleSubmit();">创建</button>
                    </div>
                </div>
                <!-- 寄存器 -->
                <div class="card mt-4 bg-light">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-2">
                                <input type="text" class="form-control" ng-model="register.name" placeholder="寄存器名称">
                            </div>
                            <div class="col-md">
                                <input type="text" class="form-control" ng-model="register.fullname" placeholder="全称">
                            </div>
                            <div class="col-md-2">
                                <input type="text" class="form-control" ng-model="register.address" placeholder="地址，比如0x04">
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md">
                                <textarea class="form-control" rows="6" ng-model="register.desc" placeholder="寄存器描述"></textarea>
                            </div>
                        </div>                        
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md text-right">
                        <button type="button" class="btn btn-outline-danger px-3" ng-show="register.id" data-toggle="modal" data-target="#registerDeleteConfirmWnd">删除</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="register.id" ng-click="registerSubmit();">编辑</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="module.id && !register.id" ng-click="registerSubmit();">创建</button>
                    </div>
                </div>
                <!-- 位组 -->
                <div class="card mt-4 bg-light">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-2">
                                <input type="text" class="form-control" ng-model="bits.name" placeholder="位组名称">
                            </div>
                            <div class="col-md">
                                <input type="text" class="form-control" ng-model="bits.fullname" placeholder="全称">
                            </div>
                            <div class="col-md-2">
                                <input type="text" class="form-control" ng-model="bits.rw" placeholder="读写权限">
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md">
                                <input type="text" class="form-control" ng-model="bits.bitlist" placeholder="位组序号列表，用逗号分开，比如:1,2,3,4,5,7">
                            </div>
                            <div class="col-md">
                                <input type="text" class="form-control" ng-model="bits.valuelist" placeholder="位组复位值列表，用逗号分开，与序号对应，比如：1,1,1,0,0,1">
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md">
                                <textarea class="form-control" rows="6" ng-model="bits.desc" placeholder="寄存器描述"></textarea>
                            </div>
                        </div>                        
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md text-right">
                        <button type="button" class="btn btn-outline-danger px-3" ng-show="bits.id" data-toggle="modal" data-target="#bitsDeleteConfirmWnd">删除</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="bits.id" ng-click="bitsSubmit();">编辑</button>
                        <button type="button" class="btn btn-outline-success px-3" ng-show="register.id && !bits.id" ng-click="bitsSubmit();">创建</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- chip 删除确认 -->
        <div class="modal fade" tabindex="-1" role="dialog" id="chipDeleteConfirmWnd">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">芯片删除确认</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                        <div class="modal-body">
                            <p>该操作将删除与该芯片相关的所有信息，包括芯片模块/寄存器/位组，以及芯片和芯片模块关联的文章。确认要删除吗？</p>
                        </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger px-4" data-dismiss="modal" ng-click="chipDelete();">删除</button>
                        <button type="button" class="btn btn-secondary px-4" data-dismiss="modal">取消</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- module 删除确认 -->
        <div class="modal fade" tabindex="-1" role="dialog" id="moduleDeleteConfirmWnd">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">模块删除确认</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                        <div class="modal-body">
                            <p>该操作将删除与该模块相关的所有信息，包括寄存器/位组，以及关联的文章。确认要删除吗？</p>
                        </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger px-4" data-dismiss="modal" ng-click="moduleDelete();">删除</button>
                        <button type="button" class="btn btn-secondary px-4" data-dismiss="modal">取消</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- register 删除确认 -->
        <div class="modal fade" tabindex="-1" role="dialog" id="registerDeleteConfirmWnd">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">寄存器删除确认</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                        <div class="modal-body">
                            <p>该操作将删除与该寄存器相关的位组。确认要删除吗？</p>
                        </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger px-4" data-dismiss="modal" ng-click="registerDelete();">删除</button>
                        <button type="button" class="btn btn-secondary px-4" data-dismiss="modal">取消</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- bits 删除确认 -->
        <div class="modal fade" tabindex="-1" role="dialog" id="bitsDeleteConfirmWnd">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">位组删除确认</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                        <div class="modal-body">
                            <p>该操作将删除该位组。确认要删除吗？</p>
                        </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger px-4" data-dismiss="modal" ng-click="bitsDelete();">删除</button>
                        <button type="button" class="btn btn-secondary px-4" data-dismiss="modal">取消</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
